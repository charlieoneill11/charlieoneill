<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NLP with limited data | Charlie O’Neill</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="NLP with limited data" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Few and no-shot learning" />
<meta property="og:description" content="Few and no-shot learning" />
<link rel="canonical" href="https://charlieoneill11.github.io/charlieoneill/python/pytorch/nlp/huggingface/2022/08/22/nlp_few.html" />
<meta property="og:url" content="https://charlieoneill11.github.io/charlieoneill/python/pytorch/nlp/huggingface/2022/08/22/nlp_few.html" />
<meta property="og:site_name" content="Charlie O’Neill" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-22T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NLP with limited data" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-22T00:00:00-05:00","datePublished":"2022-08-22T00:00:00-05:00","description":"Few and no-shot learning","headline":"NLP with limited data","mainEntityOfPage":{"@type":"WebPage","@id":"https://charlieoneill11.github.io/charlieoneill/python/pytorch/nlp/huggingface/2022/08/22/nlp_few.html"},"url":"https://charlieoneill11.github.io/charlieoneill/python/pytorch/nlp/huggingface/2022/08/22/nlp_few.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/charlieoneill/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://charlieoneill11.github.io/charlieoneill/feed.xml" title="Charlie O'Neill" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GCXCVHTN45"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GCXCVHTN45');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/charlieoneill/images/charlie.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/charlieoneill/">Charlie O&#39;Neill</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/charlieoneill/about/">About Me</a><a class="page-link" href="/charlieoneill/pubsandtalks/">Publications and Talks</a><a class="page-link" href="/charlieoneill/search/">Search</a><a class="page-link" href="/charlieoneill/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">NLP with limited data</h1><p class="page-description">Few and no-shot learning</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-08-22T00:00:00-05:00" itemprop="datePublished">
        Aug 22, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/charlieoneill/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/charlieoneill/categories/#pytorch">pytorch</a>
        &nbsp;
      
        <a class="category-tags-link" href="/charlieoneill/categories/#nlp">nlp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/charlieoneill/categories/#huggingface">huggingface</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/charlieoneill11/charlieoneill/tree/master/_notebooks/2022-08-22-nlp_few.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/charlieoneill/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/charlieoneill11/charlieoneill/master?filepath=_notebooks%2F2022-08-22-nlp_few.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/charlieoneill/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/charlieoneill11/charlieoneill/blob/master/_notebooks/2022-08-22-nlp_few.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/charlieoneill/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fcharlieoneill11%2Fcharlieoneill%2Fblob%2Fmaster%2F_notebooks%2F2022-08-22-nlp_few.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/charlieoneill/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-08-22-nlp_few.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">dataset_url</span> <span class="o">=</span> <span class="s2">"https://git.io/nlp-with-transformers"</span>
<span class="n">df_issues</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">dataset_url</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">df_issues</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>DataFrame shape: (9930, 26)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"url"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"user"</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">,</span> <span class="s2">"state"</span><span class="p">,</span> <span class="s2">"created_at"</span><span class="p">,</span> <span class="s2">"body"</span><span class="p">]</span>
<span class="n">df_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>url</th>
      <td>https://api.github.com/repos/huggingface/trans...</td>
    </tr>
    <tr>
      <th>id</th>
      <td>849529761</td>
    </tr>
    <tr>
      <th>title</th>
      <td>[DeepSpeed] ZeRO stage 3 integration: getting ...</td>
    </tr>
    <tr>
      <th>user</th>
      <td>{'login': 'stas00', 'id': 10676103, 'node_id':...</td>
    </tr>
    <tr>
      <th>labels</th>
      <td>[{'id': 2659267025, 'node_id': 'MDU6TGFiZWwyNj...</td>
    </tr>
    <tr>
      <th>state</th>
      <td>open</td>
    </tr>
    <tr>
      <th>created_at</th>
      <td>2021-04-02 23:40:42</td>
    </tr>
    <tr>
      <th>body</th>
      <td>**[This is not yet alive, preparing for the re...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span>
                       <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">meta</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span> <span class="k">for</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]))</span>
<span class="n">df_issues</span><span class="p">[[</span><span class="s2">"labels"</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>labels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[DeepSpeed]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>labels</th>
      <td>6440</td>
      <td>3057</td>
      <td>305</td>
      <td>100</td>
      <td>25</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_counts</span> <span class="o">=</span> <span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of labels: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_counts</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># Display the top-8 label categories</span>
<span class="n">df_counts</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of labels: 65
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wontfix</th>
      <th>model card</th>
      <th>Core: Tokenization</th>
      <th>New model</th>
      <th>Core: Modeling</th>
      <th>Help wanted</th>
      <th>Good First Issue</th>
      <th>Usage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>labels</th>
      <td>2284</td>
      <td>649</td>
      <td>106</td>
      <td>98</td>
      <td>64</td>
      <td>52</td>
      <td>50</td>
      <td>46</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Core: Tokenization"</span><span class="p">:</span> <span class="s2">"tokenization"</span><span class="p">,</span>
             <span class="s2">"New model"</span><span class="p">:</span> <span class="s2">"new model"</span><span class="p">,</span>
             <span class="s2">"Core: Modeling"</span><span class="p">:</span> <span class="s2">"model training"</span><span class="p">,</span>
             <span class="s2">"Usage"</span><span class="p">:</span> <span class="s2">"usage"</span><span class="p">,</span>
             <span class="s2">"Core: Pipeline"</span><span class="p">:</span> <span class="s2">"pipeline"</span><span class="p">,</span>
             <span class="s2">"TensorFlow"</span><span class="p">:</span> <span class="s2">"tensorflow or tf"</span><span class="p">,</span>
             <span class="s2">"PyTorch"</span><span class="p">:</span> <span class="s2">"pytorch"</span><span class="p">,</span>
             <span class="s2">"Examples"</span><span class="p">:</span> <span class="s2">"examples"</span><span class="p">,</span>
             <span class="s2">"Documentation"</span><span class="p">:</span> <span class="s2">"documentation"</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">filter_labels</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">label_map</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">label_map</span><span class="p">]</span>

<span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_labels</span><span class="p">)</span>
<span class="n">all_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">label_map</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_counts</span> <span class="o">=</span> <span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">df_counts</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tokenization</th>
      <th>new model</th>
      <th>model training</th>
      <th>usage</th>
      <th>pipeline</th>
      <th>tensorflow or tf</th>
      <th>pytorch</th>
      <th>documentation</th>
      <th>examples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>labels</th>
      <td>106</td>
      <td>98</td>
      <td>64</td>
      <td>46</td>
      <td>42</td>
      <td>41</td>
      <td>37</td>
      <td>28</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"split"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"unlabeled"</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">df_issues</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">df_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s2">"split"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"labeled"</span>
<span class="n">df_issues</span><span class="p">[</span><span class="s2">"split"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>split</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>unlabeled</th>
      <td>9489</td>
    </tr>
    <tr>
      <th>labeled</th>
      <td>441</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"body"</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df_issues</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">26</span><span class="p">][:</span><span class="mi">500</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>title: Add new CANINE model

body: # 🌟 New model addition

## Model description

Google recently proposed a new **C**haracter **A**rchitecture with **N**o tokenization **I**n **N**eural **E**ncoders architecture (CANINE). Not only the title is exciting:

&gt; Pipelined NLP systems have largely been superseded by end-to-end neural modeling, yet nearly all commonly-used models still require an explicit tokenization step. While recent tokenization approaches based on data-derived subword lexicons are less brittle than manually en

labels: ['new model']

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_issues</span>
                     <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s2">"body"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">len_before</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_issues</span><span class="p">)</span>
<span class="n">df_issues</span> <span class="o">=</span> <span class="n">df_issues</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s2">"text"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Removed </span><span class="si">{</span><span class="p">(</span><span class="n">len_before</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">df_issues</span><span class="p">))</span><span class="o">/</span><span class="n">len_before</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2"> duplicates."</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Removed 1.88% duplicates.
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="p">(</span><span class="n">df_issues</span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
 <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"C0"</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Words per issue"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of words"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Number of issues"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MultiLabelBinarizer</span>

<span class="n">mlb</span> <span class="o">=</span> <span class="n">MultiLabelBinarizer</span><span class="p">()</span>
<span class="n">mlb</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">all_labels</span><span class="p">])</span>
<span class="n">mlb</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="s2">"tokenization"</span><span class="p">,</span> <span class="s2">"new model"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"pytorch"</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0, 0, 0, 1, 0, 0, 0, 1, 0],
       [0, 0, 0, 0, 0, 1, 0, 0, 0]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">skmultilearn.model_selection</span> <span class="kn">import</span> <span class="n">iterative_train_test_split</span>

<span class="k">def</span> <span class="nf">balanced_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">mlb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">])</span>
    <span class="n">ind_train</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ind_test</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iterative_train_test_split</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                                                           <span class="n">test_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ind_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ind_test</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">df_clean</span> <span class="o">=</span> <span class="n">df_issues</span><span class="p">[[</span><span class="s2">"text"</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">,</span> <span class="s2">"split"</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_unsup</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_clean</span><span class="p">[</span><span class="s2">"split"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"unlabeled"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"text"</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">]]</span>
<span class="n">df_sup</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_clean</span><span class="p">[</span><span class="s2">"split"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"labeled"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"text"</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">]]</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_tmp</span> <span class="o">=</span> <span class="n">balanced_split</span><span class="p">(</span><span class="n">df_sup</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">df_valid</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">balanced_split</span><span class="p">(</span><span class="n">df_tmp</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetDict</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">DatasetDict</span><span class="p">({</span>
    <span class="s2">"train"</span><span class="p">:</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_valid</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="s2">"test"</span><span class="p">:</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="s2">"unsup"</span><span class="p">:</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df_unsup</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">all_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">"train"</span><span class="p">]))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">indices_pool</span> <span class="o">=</span> <span class="n">all_indices</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">mlb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">"train"</span><span class="p">][</span><span class="s2">"labels"</span><span class="p">])</span>
<span class="n">train_samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
<span class="n">train_slices</span><span class="p">,</span> <span class="n">last_k</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_samples</span><span class="p">):</span>
    <span class="c1"># Split off samples necessary to fill the gap to the next split size</span>
    <span class="n">indices_pool</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">new_slice</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">iterative_train_test_split</span><span class="p">(</span>
        <span class="n">indices_pool</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">last_k</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
    <span class="n">last_k</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">train_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_slice</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">train_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">train_slices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_slice</span><span class="p">)))</span>

<span class="c1"># Add full dataset as last slice</span>
<span class="n">train_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_indices</span><span class="p">),</span> <span class="n">train_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">"train"</span><span class="p">]))</span>
<span class="n">train_slices</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">train_slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">train_slice</span> <span class="ow">in</span> <span class="n">train_slices</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Target split sizes:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Actual split sizes:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train_slices</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Target split sizes:
[8, 16, 32, 64, 128, 223]
Actual split sizes:
[10, 19, 36, 68, 134, 223]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">prepare_labels</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
    <span class="n">batch</span><span class="p">[</span><span class="s2">"label_ids"</span><span class="p">]</span> <span class="o">=</span> <span class="n">mlb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">"labels"</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">batch</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">prepare_labels</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">macro_scores</span><span class="p">,</span> <span class="n">micro_scores</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">),</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">skmultilearn.problem_transform</span> <span class="kn">import</span> <span class="n">BinaryRelevance</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="k">for</span> <span class="n">train_slice</span> <span class="ow">in</span> <span class="n">train_slices</span><span class="p">:</span>
    <span class="c1"># Get training slice and test data</span>
    <span class="n">ds_train_sample</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">"train"</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">train_slice</span><span class="p">)</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds_train_sample</span><span class="p">[</span><span class="s2">"label_ids"</span><span class="p">])</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">"test"</span><span class="p">][</span><span class="s2">"label_ids"</span><span class="p">])</span>
    <span class="c1"># Use a simple count vectorizer to encode our texts as token counts</span>
    <span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
    <span class="n">X_train_counts</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ds_train_sample</span><span class="p">[</span><span class="s2">"text"</span><span class="p">])</span>
    <span class="n">X_test_counts</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">"test"</span><span class="p">][</span><span class="s2">"text"</span><span class="p">])</span>
    <span class="c1"># Create and train our model!</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">BinaryRelevance</span><span class="p">(</span><span class="n">classifier</span><span class="o">=</span><span class="n">MultinomialNB</span><span class="p">())</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="c1"># Generate predictions and evaluate</span>
    <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_counts</span><span class="p">)</span>
    <span class="n">clf_report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span>
        <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">mlb</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Store metrics</span>
    <span class="n">macro_scores</span><span class="p">[</span><span class="s2">"Naive Bayes"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clf_report</span><span class="p">[</span><span class="s2">"macro avg"</span><span class="p">][</span><span class="s2">"f1-score"</span><span class="p">])</span>
    <span class="n">micro_scores</span><span class="p">[</span><span class="s2">"Naive Bayes"</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clf_report</span><span class="p">[</span><span class="s2">"micro avg"</span><span class="p">][</span><span class="s2">"f1-score"</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">plot_metrics</span><span class="p">(</span><span class="n">micro_scores</span><span class="p">,</span> <span class="n">macro_scores</span><span class="p">,</span> <span class="n">sample_sizes</span><span class="p">,</span> <span class="n">current_model</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">micro_scores</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">run</span> <span class="o">==</span> <span class="n">current_model</span><span class="p">:</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">,</span> <span class="n">micro_scores</span><span class="p">[</span><span class="n">run</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">,</span> <span class="n">macro_scores</span><span class="p">[</span><span class="n">run</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">,</span> <span class="n">micro_scores</span><span class="p">[</span><span class="n">run</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
                     <span class="n">linestyle</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">,</span> <span class="n">macro_scores</span><span class="p">[</span><span class="n">run</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
                     <span class="n">linestyle</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">)</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Micro F1 scores"</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Macro F1 scores"</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Test set F1 score"</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"lower right"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Number of training samples"</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">"log"</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_metrics</span><span class="p">(</span><span class="n">micro_scores</span><span class="p">,</span> <span class="n">macro_scores</span><span class="p">,</span> <span class="n">train_samples</span><span class="p">,</span> <span class="s2">"Naive Bayes"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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d9/lvvvuY9u2bbRt25YXXniBjIwMRo0axZQpU7j//vsZNGgQWVlZJCQksHnzZg444ACysrJYtmwZN954I2vXrqVp06Y89dRT9OvXr8o4SkpK2LRpE61bt67y3unp6RxwwAGMGzeO9PR0ysrK6Nu3LxMmTMDdue6661i2LGgR/dvf/sbRRx/N559/zs033wwEratffPEFqamp+/IlrfN27pYRJJtZuYXlXTKmht0yxi3KY9yiHd0y+rVvQWbYwjy4W2s6tdq/3TKKircPslvFR3PXkFu4Y5Bd66bJnHxgBsP6B4PsmjRK3G9xicjuKUEWkTrnxhtv5OCDD+bnP//5TvuPOeYYJkyYgJnx9NNP86c//am8KwZAy5YtGTRoEJ9//jknnngi7777LqeccgrJyclce+21PP744/Tp04eJEydyww038Omnn+5y75dffpmvvvqKnJwc+vbty1lnnVXtvS+77DJeeOEFbrnlFj7++GMGDRpEWloal1xyCbfeeivHHHMMy5Yt45RTTmHevHk89NBDPPbYYxx99NEUFhaSkpIS2y9mHZSQYPRul0rvdqlcNDTolrG2YHu3jHVMWbqe2SvymZezkXk5G/n3hKUAtG+RwuDurctX/evXPrXGu2Xkbylm7II1jJmzmrEL1rBpW2n5sc6tmzCsf3uGDcggs1vrOtMlRKQhUoIsIntldy29sdSiRQuuuOIKHnnkEZo0aVK+Pzs7mwsvvJCcnBy2bdtW6VzBF154IS+//DInnngiL730EjfccAOFhYWMGzeOESNGlJ+3devWXcpuL//oo4/i7tx44438+c9/5q677qry3tdccw1nn302t9xyCyNHjizvjvHxxx8zd+7c8utu3LiRgoICjj76aG677TYuvfRSfvCDH9C5c+ca+ZrVd+mpjTn1oPacetCObhkzs/PL52OeunQ9qzYW8f7MHN6fuaNbxqFdW5VPL3foXnbLyMnfwkdzVzNmzmomZOVRUrZjkN2Aji3Kk+J+7VM1yE6kjlCCLCJ10i233MJhhx22U//fm266idtuu43hw4czduzYSgfuDR8+nLvvvpt169YxdepUTjrpJDZt2kSrVq2YPn161Pc3M8466yz+8Y9/cNddd1V57y5dupCRkcGnn37KxIkTeeGFFwAoKytj/PjxOyX4AHfddRdnnHEGo0eP5ogjjuDjjz+u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">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">pipeline</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">"fill-mask"</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">"bert-base-uncased"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertForMaskedLM: ['cls.seq_relationship.weight', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movie_desc</span> <span class="o">=</span> <span class="s2">"The main characters of the movie madacascar </span><span class="se">\</span>
<span class="s2">are a lion, a zebra, a giraffe, and a hippo. "</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="s2">"The movie is about [MASK]."</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">movie_desc</span> <span class="o">+</span> <span class="n">prompt</span><span class="p">)</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Token </span><span class="si">{</span><span class="n">element</span><span class="p">[</span><span class="s1">'token_str'</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="si">{</span><span class="n">element</span><span class="p">[</span><span class="s1">'score'</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="charlieoneill11/charlieoneill"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/charlieoneill/python/pytorch/nlp/huggingface/2022/08/22/nlp_few.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/charlieoneill/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/charlieoneill/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/charlieoneill/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Posts about deep learning, machine learning, causal inference, maths and computational neuroscience. ML researcher @ Macuject. UG Science + Eco @ ANU.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/charlieoneill11" target="_blank" title="charlieoneill11"><svg class="svg-icon grey"><use xlink:href="/charlieoneill/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/charles0neill" target="_blank" title="charles0neill"><svg class="svg-icon grey"><use xlink:href="/charlieoneill/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
